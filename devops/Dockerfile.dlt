FROM python:3.12-bullseye

WORKDIR /app

# Cache dependencies to speed up builds
COPY devops/dlt-requirements.txt .
RUN pip install -r dlt-requirements.txt

COPY ./src/dlt /app/src
WORKDIR /app/src

# NOTE - This is to offset dlt's native behavior or normalizing destination schemas
# We never want this enabled, so it's toggled off here by default
ENV DESTINATION__BIGQUERY__ENABLE_DATASET_NAME_NORMALIZATION=false


CMD ["python", "import_single_table_to_bigquery.py"]